---
title: "Your Project Name Here"
author: "Your Group Name Here"
format: html
editor: 
  markdown: 
    wrap: sentence
---

## Introduction

(Your text here)

## Research Questions

#### 1. Does median income have a positive relationship with the proportion of working graduates?

H: Median income will have a positive relationship with the number of working graduates.

A positive relationship and significant p-value will prove this to be true.

#### 2. Which US region contributes most to median earnings?

H0: All regions do not differ significantly for median earnings

HA: Eastern region will be the most significant in median earnings compared to other regions.

#### 3. Which degree length leads to higher median salary?

H0: Median salary does not significantly differ between degree lengths.

HA: People with 4 year degrees have higher median salaries compared to other degree lengths.

## Data Exploration

##### Install Packages

```{r}
# install.packages("causaldata")
library(dplyr)
library(causaldata)
library(tidyr)
library(ggplot2)

?scorecard
```

##### Manipulate Data

```{r}
# Organize states into regions 
scorecard$region <- state.region[match(scorecard$state_abbr, state.abb)]
scorecard <- na.omit(scorecard)

# Change variable name to 'degree'
scorecard = scorecard %>%
  mutate(degree = as.factor(pred_degree_awarded_ipeds))

glimpse(scorecard)
```

##### Region Exploration

```{r}
scorecard %>% ggplot(aes(x = region, y = earnings_med, fill = region)) +
  geom_boxplot() +
  labs(title = "Graduate Median Earnings Based on Region",
       x = "Region",
       y = "Median Earnings" ) +
  scale_fill_brewer(palette = "Set2") +  
  theme_minimal()

scorecard1 <- scorecard %>% gather(key = "employment_status", value = "working", -c(unitid,inst_name,state_abbr, pred_degree_awarded_ipeds, year, earnings_med,region,degree)) 

scorecard1 <- scorecard1 %>% mutate(employment_status = as.factor(employment_status))

scorecard1 %>% 
  ggplot(aes(x = earnings_med, fill = region)) +
  geom_histogram(bins = 35, col = "black") + facet_grid(~region) +
  labs(title = "Median Earnings Based on Region",
       x = "Median Earnings") + facet_grid(~region) + theme_minimal()

```

##### Employment Status vs. Median Earnings

```{r}
# Create a new dataframe with tidy long performed on status of work
scorecard1 <- scorecard %>% gather(key = "employment_status", value = "working", -c(unitid,inst_name,state_abbr, pred_degree_awarded_ipeds, year, earnings_med,region,degree)) 

scorecard1 <- scorecard1 %>% mutate(employment_status = as.factor(employment_status))

scorecard1 %>% 
  ggplot(aes(x = working, y = earnings_med, color = employment_status)) +
  geom_point() +   facet_grid(~employment_status) +
  labs(title = "Median Earnings of Graduates Based on Employment Status",
       x = "Number of Graduates",
       y = "Median Earnings") +
  scale_color_brewer(palette = "Dark2", name = "Employment Status", labels = c("Not Working", "Working")) +
  theme_minimal() +
  theme(legend.position = "top") +
  geom_smooth(method = "lm", linetype = "dashed", color = "black") 

scorecard1 %>% 
  ggplot(aes(x =  earnings_med, fill = employment_status)) +
  geom_histogram(bins = 35, col = "black") + facet_grid(~employment_status) +
  labs(title = "Median Earnings of Graduates Based on Employment Status",
       x = "Median Earnings") +
  scale_color_brewer(palette = "Dark2", name = "Employment Status", labels = c("Not Working", "Working")) +
  theme_minimal()


```

##### Degree Length vs. Median Earnings

```{r}
scorecard1 %>% 
  ggplot(aes(x = degree, y = earnings_med, fill = degree)) +
  geom_boxplot() +
  labs(title = "Median Earnings of Graduates Based on Degree Length",
       x = "Degree Length", y = "Median Earnings") +  theme_minimal() + scale_fill_discrete(labels=c('Less than 2 years', 'Two years', '4+ years')) + 
  scale_x_discrete(labels = c('Less than 2 years', 'Two years', '4+ years'))
```

##### Year vs. Median Earnings

```{r}
scorecard1$year_level <- as.factor(scorecard1$year)
scorecard1 %>% 
  ggplot(aes(x = year_level, y = earnings_med, fill = year_level)) +
  geom_boxplot() +
  labs(title = "Median Earnings of Graduates 2007 - 2014",
       x = "Year", y = "Median Earnings") +  theme_minimal()
```

##### Correlations
```{r}
scorecard$year_num <- as.numeric(scorecard$year)
library(pheatmap)
scorecard_cor <- cor(na.omit(scorecard[,c(5, 6, 7, 8)]))
pheatmap(scorecard_cor,
        treeheight_col = 0,
        treeheight_row = 0,
        display_numbers = TRUE,
        breaks = seq(-1, 1, length = 101))
```

## Multiple Linear Regression Model

(Your text here)

## Improving the Model

(Your text here)

## Formal Hypothesis Tests

(Your text here)

## Robustness of Results

(Your text here)

## Conclusions

(Your text here)
